(function(e){e.fn.weatherfeed=function(t,i,s){var o={unit:"c",image:true,country:false,highlow:true,wind:true,humidity:false,visibility:false,sunrise:false,sunset:false,forecast:false,link:false,showerror:true,linktarget:"_self",woeid:false};var i=e.extend(o,i);var u="odd";return this.each(function(o,a){var f=e(a);if(!f.hasClass("weatherFeed"))f.addClass("weatherFeed");if(!e.isArray(t))return false;var l=t.length;if(l>10)l=10;var c="";for(var o=0;o<l;o++){if(c!="")c+=",";c+="'"+t[o]+"'"}now=new Date;var h=i.woeid?"woeid":"location";var p="select * from weather.forecast where "+h+" in ("+c+") and u='"+i.unit+"'";var v="http://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(p)+"&rnd="+now.getFullYear()+now.getMonth()+now.getDay()+now.getHours()+"&format=json&callback=?";e.ajax({type:"GET",url:v,dataType:"json",success:function(t){if(t.query){if(t.query.results.channel.length>0){var n=t.query.results.channel.length;for(var r=0;r<n;r++){m(a,t.query.results.channel[r],i)}}else{m(a,t.query.results.channel,i)}if(e.isFunction(s))s.call(this,f)}else{if(i.showerror)f.html("<p>Weather information unavailable</p>")}},error:function(e){if(i.showerror)f.html("<p>Weather request failed</p>")}});var m=function(t,r,i){var s=e(t);if(r.description!="Yahoo! Weather Error"){var o=r.wind.direction;if(o>=348.75&&o<=360){o="N"}if(o>=0&&o<11.25){o="N"}if(o>=11.25&&o<33.75){o="NNE"}if(o>=33.75&&o<56.25){o="NE"}if(o>=56.25&&o<78.75){o="ENE"}if(o>=78.75&&o<101.25){o="E"}if(o>=101.25&&o<123.75){o="ESE"}if(o>=123.75&&o<146.25){o="SE"}if(o>=146.25&&o<168.75){o="SSE"}if(o>=168.75&&o<191.25){o="S"}if(o>=191.25&&o<213.75){o="SSW"}if(o>=213.75&&o<236.25){o="SW"}if(o>=236.25&&o<258.75){o="WSW"}if(o>=258.75&&o<281.25){o="W"}if(o>=281.25&&o<303.75){o="WNW"}if(o>=303.75&&o<326.25){o="NW"}if(o>=326.25&&o<348.75){o="NNW"}var a=r.item.forecast[0];wpd=r.item.pubDate;n=wpd.indexOf(":");tpb=g(wpd.substr(n-2,8));tsr=g(r.astronomy.sunrise);tss=g(r.astronomy.sunset);if(tpb>tsr&&tpb<tss){daynight="day"}else{daynight="night"}var f='<div class="weatherItem '+u+" "+daynight+'"';if(i.image)f+=' style="background-image: url(http://l.yimg.com/a/i/us/nws/weather/gr/'+r.item.condition.code+daynight.substring(0,1)+'.png); background-repeat: no-repeat;"';f+=">";f+='<div class="weatherCity">'+r.location.city+"</div>";if(i.country)f+='<div class="weatherCountry">'+r.location.country+"</div>";f+='<div class="weatherTemp">'+r.item.condition.temp+"&deg;</div>";f+='<div class="weatherDesc">'+r.item.condition.text+"</div>";if(i.highlow)f+='<div class="weatherRange">High: '+a.high+"&deg; Low: "+a.low+"&deg;</div>";if(i.wind)f+='<div class="weatherWind">Wind: '+o+" "+r.wind.speed+r.units.speed+"</div>";if(i.humidity)f+='<div class="weatherHumidity">Humidity: '+r.atmosphere.humidity+"</div>";if(i.visibility)f+='<div class="weatherVisibility">Visibility: '+r.atmosphere.visibility+"</div>";if(i.sunrise)f+='<div class="weatherSunrise">Sunrise: '+r.astronomy.sunrise+"</div>";if(i.sunset)f+='<div class="weatherSunset">Sunset: '+r.astronomy.sunset+"</div>";f+="</div>";if(i.forecast){f+='<div class="weatherForecast">';var l=r.item.forecast;for(var c=0;c<l.length;c++){f+='<div class="weatherForecastItem" style="background-image: url(http://l.yimg.com/a/i/us/nws/weather/gr/'+l[c].code+'s.png); background-repeat: no-repeat;">';f+='<div class="weatherForecastDay">'+l[c].day+"</div>";f+='<div class="weatherForecastDate">'+l[c].date+"</div>";f+='<div class="weatherForecastText">'+l[c].text+"</div>";f+='<div class="weatherForecastRange">High: '+l[c].high+" Low: "+l[c].low+"</div>";f+="</div>"}}if(i.link)f+='<div class="weatherLink"><a href="'+r.link+'" target="'+i.linktarget+'" title="Read full forecast">Full forecast</a></div>'}else{var f='<div class="weatherItem '+u+'">';f+='<div class="weatherError">City not found</div>'}f+="</div>";if(u=="odd"){u="even"}else{u="odd"}s.append(f)};var g=function(e){d=new Date;r=new Date(d.toDateString()+" "+e);return r}})}})(jQuery)